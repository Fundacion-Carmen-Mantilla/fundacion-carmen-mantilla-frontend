<!-- menu.component.html -->
<nav class="navbar navbar-expand-lg navbar-light shadow">
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbar-content" aria-controls="navbar-content"
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbar-content">
      <ul class="navbar-nav mx-auto">
        @for (menuItem of menuItems; track menuItem) {
          <li class="nav-item" [ngClass]="{ 'dropdown': menuItem.items?.length }">
            @if (!menuItem.items?.length) {
              <a class="nav-link" [routerLink]="menuItem.url" [attr.target]="menuItem.target">
                {{ menuItem.label }}
              </a>
            } @else {
              <a class="nav-link dropdown-toggle" href="#" role="button"
                 (click)="toggleDropdown($event, 0)">
                {{ menuItem.label }}
              </a>
              <ul class="dropdown-menu">
                <ng-container *ngTemplateOutlet="menuLevel; context: {
                  $implicit: menuItem.items,
                  level: 1
                }">
                </ng-container>
              </ul>
            }
          </li>
        }
      </ul>
    </div>
  </div>
</nav>

<ng-template #menuLevel let-items let-level="level">
  @for (item of items; track item) {
    <li [ngClass]="{ 'dropdown-submenu': item.items?.length }">
      @if (!item.items?.length) {
        <a class="dropdown-item" [routerLink]="item.url" [attr.target]="item.target">
          {{ item.label }}
        </a>
      } @else {
        <a class="dropdown-item dropdown-toggle" href="#"
           (click)="toggleDropdown($event, level)">
          {{ item.label }}
        </a>
        <ul class="dropdown-menu">
          <ng-container *ngTemplateOutlet="menuLevel; context: {
            $implicit: item.items,
            level: level + 1
          }">
          </ng-container>
        </ul>
      }
    </li>
  }
</ng-template>
